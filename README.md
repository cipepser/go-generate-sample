# go-generate-sample

## stringerのインストール

```sh
go get golang.org/x/tools/cmd/stringer
```

## go generateする前

```go
// food.go
package food

type Fruit int

const (
	Apple Fruit = iota
	Orange
)
```

```go
// main.go
package main

import (
	"fmt"

	"github.com/cipepser/go-generate-sample/food"
)

func main() {
	apple := food.Apple

	fmt.Println(apple)
}
```

実行する。

```sh
❯ go run main.go
0
```

## go generate

```go
// food.go
package food

//go:generate stringer -type=Fruit
type Fruit int

const (
	Apple Fruit = iota
	Orange
)
```

```sh
❯ cd food
❯ go generate
```

`fruit_string.go`が生成される。

```go
// fruit_string.go
// Code generated by "stringer -type=Fruit"; DO NOT EDIT.

package food

import "strconv"

const _Fruit_name = "AppleOrange"

var _Fruit_index = [...]uint8{0, 5, 11}

func (i Fruit) String() string {
	if i < 0 || i >= Fruit(len(_Fruit_index)-1) {
		return "Fruit(" + strconv.FormatInt(int64(i), 10) + ")"
	}
	return _Fruit_name[_Fruit_index[i]:_Fruit_index[i+1]]
}
```

実行する。

```sh
❯ go run main.go
Apple
```

`stringer`が`String()`を実装してくれる。

## References
* [go generateでコードを自動生成する](https://techblog.haroid.io/go-generate/)
* [stringer - GoDoc](https://godoc.org/golang.org/x/tools/cmd/stringer)